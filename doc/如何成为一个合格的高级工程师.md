# 如何成为一个合格的高级工程师

##计算机基础

- 操作系统原理
- 编译原理
- 网络通信

##Java基础

- NIO、AIO
- 多线程
- 虚拟机
- JVisual等分析调试工具使用

### 多线程

线程安全的概念及线程并发问题在虚拟机内存中的表示。

堆和栈，每个线程都有自己的栈。

#### 线程的上下文切换

一个处理器在一个时间段只能处理一个线程。通过为不同线程分配处理时间并来回切换达到并发执行的状态。处理器切换线程处理称为上下文切换。被切换出的线程被暂停，剥夺处理器使用权，称为切出。另一个线程被分配然后继续执行，称为切入。被切出的，操作系统需要保存线程的进度信息，被切入的操作系统要载入进度信息。

- 自发性上下文切换：
  - Thread.sleep()
  - Object.wait()
  - Thread.yield()*，可能也不会导致切换
  - Thread.join()
  - LockSupport.park()
  - IO阻塞
  - 等待锁
- 非自发性上下文切换
  - 时间用完
  - 更高优先级的线程需要运行
  - 虚拟机垃圾回收，在回收过程中，停止所有应用线程

上下文切换会有一些开销，时间是微妙级别的。线程越多，导致上下文切换的开销就可能越大。设计多线程程序时，减少上下文切换也是一个考量。

### 活性故障

- 死锁
- 锁死
- 活锁
- 饥饿

#### volatile关键字

理解了虚拟机中多线程的内存模型，就很容易理解volatile的作用。

####Atomic原子类

对于基本类型，除了有对应的包装类，还有对应的原子类。提供保证自增等功能的原子性，达到线程安全的目的。

####锁

使用锁，是最简单保障线程安全的方式。但是由于使用锁，会带来性能损耗，会造成其他未获得锁的线程的等待。在Java环境中，~~还会由于用户空间和内核空间的上下文切换导致应用的停顿~~。使用不当，还会出现死锁的问题。

synchrioned

Lock

读写分离锁

无锁的几种实现

CAS：compare and swape，比较和替换。乐观锁。适用于读多写少的场景。

ThreadLocal

无状态对象

不可变对象

死锁



####线程安全的容器

ConcurrentHashMap，线程安全的Map实现，通过将Map分为多个Buhget，减少锁的粒度

BlockQueue、BlockDeque

CopyOnWriteList、CopyOnWriteSet

####线程池

推荐ThreadFactory来创建线程池，好处是可以指定线程的名称，在日志中可以方便查看，二是可以指定队列大小，防止极端情况下塞满等待队列导致OOM。

####线程调度与协作

wait与notify

CountDownLatch

####性能优化

#####虚拟机对锁的优化

- 锁消除
- 锁粗化
- 偏向锁
- 适应性锁

## 框架使用

- Spring
- Spring Boot
- Spring Cloud

Spring Boot理解自动配置的原理，以及能够调整自动配置和自定义Spring Boot Starter。理解Actuator，能为应用加入健康检查。

熟练使用Spring Cloud，需要先对分布式系统有所了解。了解分布式系统的特性和会碰到的问题以及对应的解决方案。Spring Cloud提供网关，配置中心，服务注册和发现中心等分布式系统常用的组件。还提供分布式锁、领导选举，熔断器等更基础的功能。

##中间件

- RocketMQ、RabbitMQ、Kafka等消息队列
- Redis、Memcache等缓存
- MongoDB、InfluxDB等NoSQL
- Zookeeper等分布式系统协调工具
- Docker

## 数据库

索引

慢SQL

高可用：冗余，主从，备份

高性能：读写分离，分库分表，缓存

海量数据：分库分表

## 安全

密码学

HTTPS与SSL

摘要与信息的完整性和防篡改

签名

证书。证书包含很多东西，生成证书的时候，会包含摘要生成算法，和公钥和私钥。

###常见的Web攻击方式

SQL注入：

XSS跨站脚本攻击：分为多种。作为网站的提供方，需要做的是将用户提交的内容进行过滤，防止用户提交可执行的JavaScript脚本导致网站的其他用户受影响。Cookie设置为http only

CSRF跨站请求伪造：依据用户访登录过其他网站，恶意代码带上用户在其他网站的凭证，伪造用户请求访问或修改用户在其他网站上的敏感数据。添加token参数，后端进行校验。

拒绝服务攻击：

## 系统设计

- 敏捷开发、极限编程
- 常见架构
- 系统集成

高并发系统会碰到的问题？及对应的解决方案

如何做到高可用，就是提供集群。那么集群怎么协调，怎么扩容和缩容，怎么负载均衡。一种做法是提供命名服务，这很常见，比如分布式服务框架的做法，比如RocketMQ有个namesvr，不一而足。那命名服务如何高可用？

还有一种类似于nginx提供负载均衡。

HTTP Status Code的设计，成功返回200，请求参数错误返回400，业务数据未找到不建议返回404，服务端错误返回503，未登录返回401（这个待确认），登录但没有操作权限返回40？（这个待确认），超过限流返回429。

###性能问题

QPS，单机可以达到800～1000。提升QPS：多级缓存；集群。

TPS：每秒事务处理数。

响应时间和吞吐量。提升响应时间附带能提升吞吐量。通过消息队列，集群可以提升吞吐量。

性能测试一般在集成测试之后，交付之前。由客户提出要求，当然不提要求可能就跳过性能测试直接验收交付了。完成性能测试之后生成测试报告交与客户。性能测试有时会包含边界测试（压力测试），测试当系统达到指标之后，系统的最大负载能力。性能测试需要与很多的监控工具一起使用，当测试结果不达标时，根据监控记录能够方便的找到系统的最大瓶颈所在，针对性地优化。

优化，分为应用和数据库的优化。应用的优化，1.集群2.缓存3.异步。数据库的优化：读写分离，分库分表。



灰度发布/蓝绿部署

## 分布式

分布式计算、分布式存储、分布式服务

CAP理论：

- C，一致性。网络、软件系统、操作系统等等原因，部分节点写入，部分节点没有写入，各节点之间数据不一致。满足一致性，需要保证各个节点数据都为一致。
- P，分区容忍性。遇到网络故障，集群各分区无法通信，集群依然可用
- A，可用性。任何时候对集群进行读写操作，都能正常响应

对于分布式系统，网络不可控，出现网络分区不可避免，所以分布式系统一定需要分区容忍性，即P一定保证。这样分布式系统一般就分为CP和AP。

服务治理？服务治理的概念，包含的内容。服务的降级，容错，熔断，路由，注册与发现，限流，安全

## DevOps

